(function() {

"use strict";

var BitriseWorkflowEditor = angular.module("BitriseWorkflowEditor", [
	"ngRoute",
	"ngSanitize",
	"ngAnimate"
]);

BitriseWorkflowEditor.config(function($compileProvider) {
	$compileProvider.debugInfoEnabled(false);
});

BitriseWorkflowEditor.config(function($animateProvider) {
	$animateProvider.classNameFilter(/angular-animated/);
});

BitriseWorkflowEditor.config(function($locationProvider) {
	$locationProvider.html5Mode(true);
});

BitriseWorkflowEditor.config(function($routeProvider) {

	var routes = [{
		endpoints: ["", "/"],
		configuration: {
			redirectTo: "/editor"
		}
	}, {
		endpoints: ["<%= data[:routes][:editor] %>"],
		configuration: {
			templateUrl: "<%= data[:routes][:editor_template] %>"
		}
	}, {
		endpoints: ["<%= data[:routes][:code_signing] %>"],
		configuration: {
			templateUrl: "<%= data[:routes][:code_signing_template] %>",
			controller: "CodeSigningController",
			controllerAs: "codeSigningCtrl"
		}
	}, {
		endpoints: ["<%= data[:routes][:secrets] %>"],
		configuration: {
			templateUrl: "<%= data[:routes][:secrets_template] %>",
		}
	}, {
		endpoints: ["<%= data[:routes][:app_env_vars] %>"],
		configuration: {
			templateUrl: "<%= data[:routes][:app_env_vars_template] %>",
		}
	}, {
		endpoints: ["<%= data[:routes][:triggers] %>"],
		configuration: {
			templateUrl: "<%= data[:routes][:triggers_template] %>",
			controller: "TriggersController",
			controllerAs: "triggersCtrl"
		}
	}, {
		endpoints: ["<%= data[:routes][:yml] %>"],
		configuration: {
			templateUrl: "<%= data[:routes][:yml_template] %>",
			controller: "YMLController",
			controllerAs: "ymlCtrl"
		}
	}];

	var defaultRoute = routes[0];
	var defaultEndpoint = routes[0].endpoints[0];

	_.each(routes, function(aRoute) {
		_.each(aRoute.endpoints, function(anEndpoint) {
			$routeProvider.when(anEndpoint, aRoute.configuration);
		});
	});

	$routeProvider.otherwise(defaultEndpoint, defaultRoute.configuration);

});

})();
