(function() {

"use strict";

angular.module("BitriseWorkflowEditor").controller("DefaultPopupController", function($scope, $rootScope, Popup) {

	var viewModel = this;

	var types = [{
		id: "error",
		cssClass: "error"
	}];

	viewModel.alertPopup = new Popup({
		type: undefined,
		title: undefined,
		details: undefined,
		okTitle: undefined,
		cancelTitle: undefined,
		deferer: undefined,
	});

	$rootScope.$on("DefaultPopupController::showAlertPopup", function(event, typeID, title, details, okTitle, cancelTitle, deferer) {
		viewModel.alertPopup.parameters.type = _.find(types, {
			id: typeID ? typeID : "error"
		});
		viewModel.alertPopup.parameters.title = title;
		viewModel.alertPopup.parameters.details = details;
		viewModel.alertPopup.parameters.okTitle = okTitle ? okTitle : "<%= data[:strings][:alert_popup][:ok] %>";
		viewModel.alertPopup.parameters.cancelTitle = cancelTitle ? cancelTitle : "<%= data[:strings][:alert_popup][:ok] %>";

		if (deferer && deferer.resolve) {
			viewModel.alertPopup.afterDismissCallback = deferer.resolve;
		}

		viewModel.alertPopup.isVisible = true;
	});

});

})();
