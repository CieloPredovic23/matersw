(function() {
	"use strict";

	angular
		.module("BitriseWorkflowEditor")
		.controller("LicensesController", function(
			appService,
			Workflow,
			$scope,
		) {
			var viewModel = this;

			$scope.licences = [{
				id: 1,
				name: 'aLabel',
			}, {
				id: 2,
				name: 'bLabel',
			}];

			viewModel.workflowLicenseFactory = function(workflow) {

				return function(licensePoolOption) {
					if(licensePoolOption !== undefined) {
						workflow.licensePoolId(licensePoolOption.id)
					}

					var id = workflow.licensePoolId();

					if(id) {
						var licenseOption = $scope.licences.find((item) => {
							if(item.id === id) {
								return true
							}
						})

						return licenseOption;
					}

					return id;
				}
			}

			viewModel.workflows = _.map(appService.appConfig.workflows, function(
				aWorkflowConfig,
				workflowID
			) {
				return new Workflow(workflowID, aWorkflowConfig);
			});
    })

})();
