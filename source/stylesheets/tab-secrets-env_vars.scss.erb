@import "default";
@import "constants";

.tab-secrets, .tab-env-vars {

	section {
		$padding: 12px 18px;
		$border: 1px solid $def-mediumlightgrey;

		margin-bottom: 20px;
		border: $border;
		@include border-radius(6px);
		overflow: hidden;

		header {
			padding: $padding;
			background-color: $def-verylightgrey;

			h2 {
				@include margin-y(0);
				font-size: 14px;
				font-weight: 600;

				em {
					font-style: normal;
					font-weight: 100;
				}
			}

			h2:not(:last-child) {
				margin-bottom: 8px;
			}

			p {
				@include margin-y(0);
				font-size: 12px;
				font-weight: 100;
				color: $def-darkgrey;
			}
		}

		p.notification {
			@include margin-y(0);
			@include border-x(none);
			@include border-radius(0);
			padding: $padding;
		}

		article {
			$first_column-width: 330px;
			$input-height: 36px;

			background-color: white;

			ul.env-vars {
				@include margin-y(0);
				padding-left: 0;
				list-style: none;

				li {
					border-bottom: $border;
					padding: $padding;
					background-color: white;
					cursor: move;

					.key-value-delete {
						$input-horizontalpadding: 14px;

						@include display-flex;
						@include align-items(center);
						margin-bottom: 12px;

						&:before {
							content: "=";
							@include order(2);
							@include margin-x(20px);
							font-size: 16px;
							font-weight: 900;
						}

						input.key, textarea.value {
							padding: 0px $input-horizontalpadding;
							height: $input-height;
							line-height: $input-height;
							font-size: 14px;
							font-weight: 100;
						}

						input.key {
							$svg_content_with_attributes: svg_content_with_attributes('<%= svg("env_var_prefix") %>', (
								fill: white
							));
							$background_width: 8px;
							$background_reservedwidth: 30px;

							@include order(1);
							@include flex-shrink(0);
							@include box-sizing(border-box);
							width: $first_column-width;
							border: 1px solid $def-purple;
							@include border-radius($def-radius);
							padding-left: $background_reservedwidth + $input-horizontalpadding;
							color: $def-purple;
							background-image: url('data:image/svg+xml;utf8, #{ $svg_content_with_attributes }'), url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg"><rect width="#{ $background_reservedwidth }" height="#{ $input-height }" fill="#{ $def-purple }"></rect></svg>');
							background-size: $background_width auto, $background_reservedwidth 100%;
							background-position: left #{($background_reservedwidth - $background_width) / 2} center, left center;
							background-repeat: no-repeat;
						}

						textarea.value {
							@include order(3);
							@include flex-grow(1);
							@include align-self(stretch);
							@include box-sizing(border-box);
							border: 1px solid $def-mediumlightgrey;
							@include border-radius($def-radius);
						}

						button.delete {
							$color: white;

							@include order(4);
							@include flex-shrink(0);
							@include size(22px);
							margin: 6px 12px;
							margin-right: 0;
							@include border-radius($def-radius);
							color: $color;
							background-color: $def-danger;
							@include transition(background-color $def-transition_duration);

							svg {
								@include position(relative, -3px);
								@include size(8px);
								fill: $color;
							}
						}

						button.delete:focus, button.delete:hover {
							background-color: $def-danger-shade;
						}
					}

					.is-expand {
						@include display-flex;
						@include align-items(center);

						.checkbox + label {
							margin-left: 8px;
						}

						label {
							font-size: 12px;
							font-weight: 200;
						}
					}
				}

				li.dragged-element {
					z-index: $zindex-dragged_element;
					border-top: $border;
				}
			}

			button.add {
				width: $first_column-width;
				margin: $padding;
				@include border-radius($def-radius);
				padding: 10px;
				font-size: 14px;
				color: white;
				background-color: $def-green;
				@include transition(background-color $def-transition_duration);
			}

			button.add:hover, button.add:focus {
				background-color: $def-green-shade;
			}

			@include media-below-mid {
				@include display-flex;
				@include flex-direction(column);

				ul.env-vars {

					li {

						.key-value-delete {
							@include flex-direction(column);

							input.key {
								@include align-self(stretch);
							}

							&:before {
								@include margin-y(10px);
								margin-left: $first_column-width / 2;
								margin-right: auto;
							}

							textarea.value {
								width: $first_column-width;
							}

							button.delete {
								@include align-self(stretch);
								@include size($first_column-width, auto);
								margin-top: 12px;
								@include margin-x(0);
								padding: 10px;
								font-size: 14px;

								svg {
									display: none;
								}

								&:after {
									content: "<%= data[:strings][:env_vars][:delete_env_var] %>";
								}
							}
						}
					}
				}
			}

			@include media-below-small {

				ul.env-vars {

					li {

						.key-value-delete {

							input.key {
								width: auto;
							}

							textarea.value {
								width: auto;
							}

							&:before {
								@include margin-x(0);
							}

							button.delete {
								width: auto;
							}
						}
					}
				}

				button.add {
					@include flex-grow(1);
					width: auto;
				}
			}
		}
	}
}
